"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1325],{66324:function(e,t,i){i.d(t,{O:function(){return o}});var a=i(97382);function n(e){return"activeSelection"===e.type||"group"===e.type}function o(e,t,i,o,l){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return(null==r?void 0:r.current)&&(r=r.current),o||(o=[]),async function(c){for(var p=arguments.length,d=Array(p>1?p-1:0),u=1;u<p;u++)d[u-1]=arguments[u];if(!e.canvas)return i(c,...d);n(e)&&(delete r.fill,delete r.fills,delete r.stroke,delete r.patternSrc,delete e.fill,delete e.fills,delete e.stroke,delete e.patternSrc);let m={target:e,eventSource:"keyboard",e:{},action:(null==c?void 0:c.action)||l,transform:{original:{...a.fabric.util.saveObjectTransform(e),...r}}};await i(c,...d);let x=o.find(t=>JSON.stringify(m.transform.original[t])!==JSON.stringify(e[t]));return!x&&n(e)&&(x=JSON.stringify(m.transform.original)!==JSON.stringify(e)),(x||s)&&t.fire("object:modified",m),null}}},27104:function(e,t,i){i.d(t,{e:function(){return n},r:function(){return a}});let a={"audio/x-mpeg":"mpega","application/postscript":"ps","audio/x-aiff":"aiff","application/x-aim":"aim","image/x-jg":"art","video/x-ms-asf":"asx","audio/basic":"ulw","video/x-msvideo":"avi","video/x-rad-screenplay":"avx","application/x-bcpio":"bcpio","application/octet-stream":"exe","image/bmp":"dib","text/html":"html","application/x-cdf":"cdf","application/pkix-cert":"cer","application/java":"class","application/x-cpio":"cpio","application/x-csh":"csh","text/css":"css","application/msword":"doc","application/xml-dtd":"dtd","video/x-dv":"dv","application/x-dvi":"dvi","application/vnd.ms-fontobject":"eot","text/x-setext":"etx","image/gif":"gif","application/x-gtar":"gtar","application/x-gzip":"gz","application/x-hdf":"hdf","application/mac-binhex40":"hqx","text/x-component":"htc","image/ief":"ief","text/vnd.sun.j2me.app-descriptor":"jad","application/java-archive":"jar","text/x-java-source":"java","application/x-java-jnlp-file":"jnlp","image/jpeg":"jpg","application/javascript":"js","text/plain":"txt","application/json":"json","audio/midi":"midi","application/x-latex":"latex","audio/x-mpegurl":"m3u","image/x-macpaint":"pnt","text/troff":"tr","application/mathml+xml":"mathml","application/x-mif":"mif","video/quicktime":"qt","video/x-sgi-movie":"movie","audio/mpeg":"mpa","video/mp4":"mp4","video/mpeg":"mpg","video/mpeg2":"mpv2","application/x-wais-source":"src","application/x-netcdf":"nc","application/oda":"oda","application/vnd.oasis.opendocument.database":"odb","application/vnd.oasis.opendocument.chart":"odc","application/vnd.oasis.opendocument.formula":"odf","application/vnd.oasis.opendocument.graphics":"odg","application/vnd.oasis.opendocument.image":"odi","application/vnd.oasis.opendocument.text-master":"odm","application/vnd.oasis.opendocument.presentation":"odp","application/vnd.oasis.opendocument.spreadsheet":"ods","application/vnd.oasis.opendocument.text":"odt","application/vnd.oasis.opendocument.graphics-template":"otg","application/vnd.oasis.opendocument.text-web":"oth","application/vnd.oasis.opendocument.presentation-template":"otp","application/vnd.oasis.opendocument.spreadsheet-template":"ots","application/vnd.oasis.opendocument.text-template":"ott","application/ogg":"ogx","video/ogg":"ogv","audio/ogg":"spx","application/x-font-opentype":"otf","audio/flac":"flac","application/annodex":"anx","audio/annodex":"axa","video/annodex":"axv","application/xspf+xml":"xspf","image/x-portable-bitmap":"pbm","image/pict":"pict","application/pdf":"pdf","image/x-portable-graymap":"pgm","audio/x-scpls":"pls","image/png":"png","image/x-portable-anymap":"pnm","image/x-portable-pixmap":"ppm","application/vnd.ms-powerpoint":"pps","image/vnd.adobe.photoshop":"psd","image/x-quicktime":"qtif","image/x-cmu-raster":"ras","application/rdf+xml":"rdf","image/x-rgb":"rgb","application/vnd.rn-realmedia":"rm","application/rtf":"rtf","text/richtext":"rtx","application/font-sfnt":"sfnt","application/x-sh":"sh","application/x-shar":"shar","application/x-stuffit":"sit","application/x-sv4cpio":"sv4cpio","application/x-sv4crc":"sv4crc","image/svg+xml":"svgz","application/x-shockwave-flash":"swf","application/x-tar":"tar","application/x-tcl":"tcl","application/x-tex":"tex","application/x-texinfo":"texinfo","image/tiff":"tiff","text/tab-separated-values":"tsv","application/x-font-ttf":"ttf","application/x-ustar":"ustar","application/voicexml+xml":"vxml","image/x-xbitmap":"xbm","application/xhtml+xml":"xhtml","application/vnd.ms-excel":"xls","application/xml":"xsl","image/x-xpixmap":"xpm","application/xslt+xml":"xslt","application/vnd.mozilla.xul+xml":"xul","image/x-xwindowdump":"xwd","application/vnd.visio":"vsd","audio/x-wav":"wav","image/vnd.wap.wbmp":"wbmp","text/vnd.wap.wml":"wml","application/vnd.wap.wmlc":"wmlc","text/vnd.wap.wmlsc":"wmls","application/vnd.wap.wmlscriptc":"wmlscriptc","video/x-ms-wmv":"wmv","application/font-woff":"woff","application/font-woff2":"woff2","model/vrml":"wrl","application/wspolicy+xml":"wspolicy","application/x-compress":"z","application/zip":"zip"},n={aiff:"audio/x-aiff",aim:"application/x-aim",anx:"application/annodex",art:"image/x-jg",asx:"video/x-ms-asf",avi:"video/x-msvideo",avx:"video/x-rad-screenplay",axa:"audio/annodex",axv:"video/annodex",bcpio:"application/x-bcpio",cdf:"application/x-cdf",cer:"application/pkix-cert",class:"application/java",cpio:"application/x-cpio",csh:"application/x-csh",css:"text/css",dib:"image/bmp",doc:"application/msword",dtd:"application/xml-dtd",dv:"video/x-dv",dvi:"application/x-dvi",eot:"application/vnd.ms-fontobject",etx:"text/x-setext",exe:"application/octet-stream",flac:"audio/flac",gif:"image/gif",gtar:"application/x-gtar",gz:"application/x-gzip",hdf:"application/x-hdf",hqx:"application/mac-binhex40",htc:"text/x-component",html:"text/html",ief:"image/ief",jad:"text/vnd.sun.j2me.app-descriptor",jar:"application/java-archive",java:"text/x-java-source",jnlp:"application/x-java-jnlp-file",jpg:"image/jpeg",jpeg:"image/jpeg",js:"application/javascript",json:"application/json",latex:"application/x-latex",m3u:"audio/x-mpegurl",mathml:"application/mathml+xml",midi:"audio/midi",mif:"application/x-mif",movie:"video/x-sgi-movie",mp4:"video/mp4",mpa:"audio/mpeg",mpega:"audio/x-mpeg",mpg:"video/mpeg",mpv2:"video/mpeg2",nc:"application/x-netcdf",oda:"application/oda",odb:"application/vnd.oasis.opendocument.database",odc:"application/vnd.oasis.opendocument.chart",odf:"application/vnd.oasis.opendocument.formula",odg:"application/vnd.oasis.opendocument.graphics",odi:"application/vnd.oasis.opendocument.image",odm:"application/vnd.oasis.opendocument.text-master",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",ogv:"video/ogg",ogx:"application/ogg",otf:"application/x-font-opentype",otg:"application/vnd.oasis.opendocument.graphics-template",oth:"application/vnd.oasis.opendocument.text-web",otp:"application/vnd.oasis.opendocument.presentation-template",ots:"application/vnd.oasis.opendocument.spreadsheet-template",ott:"application/vnd.oasis.opendocument.text-template",pbm:"image/x-portable-bitmap",pdf:"application/pdf",pgm:"image/x-portable-graymap",pict:"image/pict",pls:"audio/x-scpls",png:"image/png",pnm:"image/x-portable-anymap",pnt:"image/x-macpaint",ppm:"image/x-portable-pixmap",pps:"application/vnd.ms-powerpoint",ps:"application/postscript",psd:"image/vnd.adobe.photoshop",qt:"video/quicktime",qtif:"image/x-quicktime",ras:"image/x-cmu-raster",rdf:"application/rdf+xml",rgb:"image/x-rgb",rm:"application/vnd.rn-realmedia",rtf:"application/rtf",rtx:"text/richtext",sfnt:"application/font-sfnt",sh:"application/x-sh",shar:"application/x-shar",sit:"application/x-stuffit",spx:"audio/ogg",src:"application/x-wais-source",sv4cpio:"application/x-sv4cpio",sv4crc:"application/x-sv4crc",svgz:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tcl:"application/x-tcl",tex:"application/x-tex",texinfo:"application/x-texinfo",tiff:"image/tiff",tr:"text/troff",tsv:"text/tab-separated-values",ttf:"application/x-font-ttf",txt:"text/plain",ulw:"audio/basic",ustar:"application/x-ustar",vsd:"application/vnd.visio",vxml:"application/voicexml+xml",wav:"audio/x-wav",wbmp:"image/vnd.wap.wbmp",wml:"text/vnd.wap.wml",wmlc:"application/vnd.wap.wmlc",wmls:"text/vnd.wap.wmlsc",wmlscriptc:"application/vnd.wap.wmlscriptc",wmv:"video/x-ms-wmv",woff:"application/font-woff",woff2:"application/font-woff2",wrl:"model/vrml",wspolicy:"application/wspolicy+xml",xbm:"image/x-xbitmap",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xpm:"image/x-xpixmap",xsl:"application/xml",xslt:"application/xslt+xml",xspf:"application/xspf+xml",xul:"application/vnd.mozilla.xul+xml",xwd:"image/x-xwindowdump",z:"application/x-compress",zip:"application/zip"}},97723:function(e,t,i){i.d(t,{So:function(){return o},Yb:function(){return r},xf:function(){return l}});var a=i(57437),n=i(2265);let o=(0,n.createContext)({project:{},activeCanvas:null,activeObject:null,canvasLoaded:!0,isRenaming:!1,toggleContextMenu:!1,eyeDropperCanvas:null,eyeDropperColor:null,notification:null,handleCleanupStore:()=>{}}),l=e=>{let{children:t}=e,[i,l]=(0,n.useState)(null),[r,s]=(0,n.useState)(null),[c,p]=(0,n.useState)(null),[d,u]=(0,n.useState)(null),[m,x]=(0,n.useState)(!0),[g,f]=(0,n.useState)(!1),[v,h]=(0,n.useState)(!1),[w,b]=(0,n.useState)(null),[j,y]=(0,n.useState)(null),S=(0,n.useCallback)(()=>{l(null),s(null),p(null),x(!0),f(!1),h(!1),b(null),u(null),y(null)},[]),N=(0,n.useMemo)(()=>({project:i,setProject:l,activeCanvas:r,setActiveCanvas:s,activeObject:c,setActiveObject:p,canvasLoaded:m,setCanvasLoaded:x,isRenaming:g,setIsRenaming:f,toggleContextMenu:v,setToggleContextMenu:h,eyeDropperCanvas:w,setEyeDropperCanvas:b,eyeDropperColor:d,setEyeDropperColor:u,notification:j,setNotification:y,handleCleanupStore:S}),[i,r,c,m,g,v,w,d,j,S]);return(0,a.jsx)(o.Provider,{value:(0,n.useMemo)(()=>({...N}),[N]),children:t})},r=()=>{let e=(0,n.useContext)(o);if(void 0===e)throw Error("useCanvasAPIStore must be used within a StoreProvider");return e}},87483:function(e,t,i){i.d(t,{G:function(){return v}});var a=i(57437),n=i(2265),o=i(44177),l=i(66324),r=i(97723),s=i(1916),c=i(80163),p=i(10733),d=i(79123),u=i(64610),m=i(78764),x=i(13495),g=i(24528);let f=e=>{let{currentImgIndex:t,setCurrentImgIndex:i,images:o,onCarouselImageClick:l,handleOnDragStart:r}=e,s=(0,n.useRef)(null),[c,p]=(0,n.useState)({showLeftArrow:!1,showRightArrow:!1}),d=e=>{let a="next"===e?Math.min(t+1,o.length-1):Math.max(t-1,0),n=document.getElementById(o[a].image.id);if(null==n||n.scrollIntoView({behavior:"smooth",inline:"center"}),t===a&&s.current&&n){let t="prev"===e?-s.current.scrollWidth:s.current.scrollWidth;s.current.scrollTo({left:t,behavior:"smooth"})}i(a)};return(0,n.useEffect)(()=>{s.current&&p({...c,showRightArrow:s.current.scrollLeft+s.current.clientWidth!==s.current.scrollWidth})},[o]),(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)("button",{"aria-label":"Previous image",className:(0,g.cn)("absolute left-2 top-1/2 z-10 hidden -translate-y-1/2 p-1 text-neutral-0 active:scale-95",{block:c.showLeftArrow}),type:"button",onClick:()=>d("prev"),children:(0,a.jsx)(x.OE,{className:"h-[18px] w-[18px] stroke-current stroke-[1.5]"})}),(0,a.jsx)(m.o,{orientation:"horizontal",hideScrollBar:!0,className:"hide-scrollbar",ref:s,onScroll:e=>{let t=e.target;p({showLeftArrow:0!==t.scrollLeft,showRightArrow:t.scrollLeft+t.clientWidth!==t.scrollWidth})},children:(0,a.jsx)("div",{className:"flex gap-2",children:o.map((e,i)=>{var n,s;let{image:c,collectionId:p}=e;return(0,a.jsx)("button",{type:"button",id:c.id,className:(0,g.cn)("m-px h-[54px] w-[54px] min-w-[54px] max-w-[54px] cursor-pointer overflow-hidden rounded-xl",{"border border-primary-400":c.id===(null===(s=o[t])||void 0===s?void 0:null===(n=s.image)||void 0===n?void 0:n.id)}),onClick:()=>l(i,p),onDragStart:e=>{r(e,i,p)},children:c.isLoading?(0,a.jsx)("div",{className:"h-full w-full animate-pulse dark:bg-neutral-700"}):(0,a.jsx)("img",{src:c.src,alt:c.id,className:"h-full w-full object-cover object-center"})},c.id)})})}),(0,a.jsx)("button",{"aria-label":"Next image",className:(0,g.cn)("absolute right-2 top-1/2 z-10 hidden -translate-y-1/2 p-1 active:scale-95",{block:c.showRightArrow}),type:"button",onClick:()=>d("next"),children:(0,a.jsx)(x.XC,{className:"h-[18px] w-[18px]"})})]})},v=e=>{var t,i;let{isLoading:m,isVariationLoading:x,isVariationSupported:g=!1,aspectRatio:v,selectedCollection:h,collections:w,setSelectedCollection:b,renderNoImages:j,handleDeleteImage:y,...S}=e,N=(0,p.Td)()(e=>e.models),C=(0,p.Td)()(e=>e.defaultSettings),E=null==h?void 0:h.settings.model,[T,I]=(0,n.useState)(0),{activeCanvas:k,activeObject:_}=(0,r.Yb)(),z=(0,c.f)(e=>e.setIsNotSaved),O=(0,n.useMemo)(()=>w.flatMap(e=>e.images.map(t=>({collectionId:e.id,image:t}))),[w]),A=(0,n.useMemo)(()=>{var e;let t=N.find(e=>e.id===(null==E?void 0:E.id));return null===(e=null==t?void 0:t.variateEnabled)||void 0===e||e},[E,N]),P=null!==(i=null==h?void 0:h.settings.aspect_ratio)&&void 0!==i?i:C.fromText.aspect_ratio,L=e=>new Promise(t=>{z(!0);let i=null==h?void 0:h.settings.prompt,a=_.toObject(o.a);Promise.all([(0,d.M6)(e),(0,d.NA)(e)]).then(async n=>{let[o,r]=n;_.aiContainer=!1,_.prompt=i,_.src=e,await (0,d.aW)(e,_),_.updatePhotoCanvas(),_.setCoords(),k.renderAll(),k.fire("photo:toolbar:update",{target:_}),t(!0),(0,s.Ih)(r.naturalHeight.toString(),r.naturalWidth.toString(),o.size.toString(),o.size.toString(),o).then(e=>{(0,l.O)(_,k,async()=>{var a;_.prompt=i,_.aiContainer=!1,_.src=e.file,await (0,d.aW)(e.file,_),_.updatePhotoCanvas(),_.setCoords(),null===(a=_.canvas)||void 0===a||a.renderAll(),k.fire("user:object:modified",{target:_}),z(!1),t(!0)},["src","width","height","aiContainer","scaleY","scaleX","prompt"],"src",a)(!0)}).catch(()=>{t(!1)})})});return((0,n.useEffect)(()=>{if(!m&&!x){let e=w.find(e=>e.id===O[0].collectionId);e&&b(e)}I(0)},[O,m,x,w,b]),0===O.length)?j():(0,a.jsxs)("div",{className:"flex h-[415px] w-full flex-col items-center justify-start gap-3",children:[(0,a.jsx)("div",{className:"flex h-[345px] items-center justify-center",children:(0,a.jsx)(u.a,{isVariationInProgress:null!=x&&x,image:null===(t=O[T])||void 0===t?void 0:t.image,isVariationSupported:g&&A,aspectRatio:0===O.length||m?v:P,onAddImageToCanvas:e=>{if(_&&"photo"===_.type)return L(e);let t=null==h?void 0:h.settings.prompt;return(0,d.PX)(k,e,t,z)},handleDeleteImage:e=>{let t=O.filter(t=>t.image.id!==e);y(e);let i=t[t.length-1];if(!i)return;let a=w.find(e=>e.id===i.collectionId);a&&b(a),I(t.length-1)},...S})}),(0,a.jsx)(f,{currentImgIndex:T,onCarouselImageClick:(e,t)=>{let i=w.find(e=>e.id===t);i&&b(i),I(e)},setCurrentImgIndex:I,handleOnDragStart:(e,t,i)=>{var a;let n=w.find(e=>e.id===i),o=O[t].image;e.dataTransfer.effectAllowed="copy",e.dataTransfer.setData("src",o.src),e.dataTransfer.setData("prompt",(null==n?void 0:null===(a=n.settings)||void 0===a?void 0:a.prompt)||""),e.currentTarget.classList.add("dragging")},images:O})]})}},30606:function(e,t,i){i.d(t,{U:function(){return c}});var a=i(57437),n=i(2265),o=i(39768),l=i(64610),r=i(10733),s=i(24528);let c=e=>{var t,i,c;let{images:p,isLoading:d,numOfImages:u,isVariationLoading:m,isVariationSupported:x=!1,isSettingsChanged:g,aspectRatio:f,selectedCollection:v,renderNoImages:h,...w}=e,b=(0,r.Td)()(e=>e.defaultSettings),j=(0,r.Td)()(e=>e.models),y=null==v?void 0:v.settings.model,S=(0,n.useMemo)(()=>{var e;let t=j.find(e=>e.id===(null==y?void 0:y.id));return null===(e=null==t?void 0:t.variateEnabled)||void 0===e||e},[y,j]),N=null!==(c=null==v?void 0:v.settings.aspect_ratio)&&void 0!==c?c:b.fromText.aspect_ratio;return 0!==p.length||d&&g?(0,a.jsx)("div",{className:"hide-scrollbar flex flex-1 overflow-y-auto pb-24",children:(0,a.jsx)("div",{className:(0,s.cn)("m-auto grid h-fit w-fit grid-rows-[repeat(1,_minmax(min-content,_1fr))] gap-3",null===(t=(i=o.Yx[N]).getClassnames)||void 0===t?void 0:t.call(i,p.length)),children:p.map(e=>(0,a.jsx)("div",{children:(0,a.jsx)(l.a,{isVariationInProgress:null!=m&&m,image:e,isVariationSupported:x&&S,aspectRatio:0===p.length?f:N,...w})},e.id))})}):h()}},64610:function(e,t,i){i.d(t,{a:function(){return y}});var a=i(57437),n=i(2265);let o=e=>{let{placeholderSettings:t}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"".concat(t.aspectRatio," group relative flex overflow-hidden dark:hidden"),children:(0,a.jsx)("div",{role:"status",className:"dark flex h-full w-full animate-pulse overflow-hidden rounded",children:(0,a.jsx)("div",{className:"inline-block h-full w-full overflow-hidden bg-neutral-20 dark:bg-neutral-40",children:(0,a.jsx)("div",{className:"".concat(t.placeholderSize," ").concat(t.aspectRatio)})})})}),(0,a.jsx)("div",{className:"".concat(t.aspectRatio," group relative hidden overflow-hidden dark:flex"),children:(0,a.jsx)("div",{role:"status",className:"flex h-full w-full animate-pulse overflow-hidden rounded",children:(0,a.jsx)("div",{className:"inline-block h-full w-full overflow-hidden bg-neutral-500 dark:bg-neutral-700",children:(0,a.jsx)("div",{className:"".concat(t.placeholderSize," ").concat(t.aspectRatio)})})})})]})};var l=i(39768),r=i(32057),s=i(24019),c=i(12600),p=i(54361),d=i(13495),u=i(43664),m=i(81149),x=i(95401),g=i(24528),f=i(40736),v=i(34124);let h=e=>{let{onClick:t,imgSrc:i}=e,[o,l]=(0,n.useState)("idle"),r=async()=>{u.c.triggerEventUsingElementId(s.i.ADD_TO_CANVAS),t&&(l("loading"),await t(i),l("completed"))};return(0,n.useEffect)(()=>{let e;return"completed"===o&&(e=setTimeout(()=>{l("idle")},1500)),()=>{e&&clearTimeout(e)}},[o]),(0,a.jsxs)("div",{className:"absolute left-1/2 top-1/2 h-9 w-[127px] -translate-x-1/2 -translate-y-1/2",children:[(0,a.jsx)("div",{className:"absolute z-[1] h-9 w-[127px] rounded-lg bg-black bg-opacity-[0.34] opacity-0 ring-1 ring-neutral-0 backdrop-blur-sm transition-all duration-500 active:translate-y-[0.0625rem] group-hover:opacity-100"}),(0,a.jsx)(m.z,{variant:"none",size:"sm",type:"submit",onClick:r,className:"absolute inset-0 z-[2] mx-auto grid h-9 w-[127px] place-items-center opacity-0 !transition-opacity duration-500 group-hover:opacity-100",children:(()=>{switch(o){case"idle":default:return"Add to Canvas";case"loading":return(0,a.jsx)(v.$,{className:"h-4 w-4"});case"completed":return"Added!"}})()})]})},w=e=>{let{children:t,className:i}=e;return(0,a.jsx)("div",{className:(0,g.cn)("absolute inline-flex flex-col items-center justify-center gap-1 rounded-lg bg-black bg-opacity-[0.34] p-1 opacity-100 backdrop-blur-sm transition-all duration-500",i),children:t})},b="rounded p-1 text-neutral-0 hover:bg-neutral-0 hover:bg-opacity-[0.24] h-8 w-8",j=e=>{let{placeholderSettings:t,image:i,isVariationSupported:n,isVariationInProgress:o,handleUpscale:l,handleFullView:v,handleDeleteImage:j,handleImageVariate:y,handleFocusOriginalImage:S,onAddImageToCanvas:N}=e,{id:C,isFocused:E=!1,isUpscaled:T=!1,upscaleSrc:I,src:k}=i,_="isVariation"in i&&i.isVariation,z="originalImageId"in i?i.originalImageId:null,O="originalSrc"in i?i.originalSrc:null,{modalContainer:A,isRenderedInsideCanvas:P,activeTool:L}=(0,r.B)(),R=(0,p.d)(),{downloadImage:M}=(0,c.q)(i),D=()=>{z&&(null==S||S(z))};return(0,a.jsxs)("div",{id:C,className:"\n        ".concat(t.aspectRatio," ").concat(t.maxH," group relative flex h-full w-fit overflow-hidden rounded"),children:[(0,a.jsx)("img",{src:T?I:k,alt:C,className:(0,g.cn)("h-full w-full rounded transition-all duration-100",{"border-2 border-primary-500":E})}),(0,a.jsx)("button",{type:"button",onClick:()=>{P||(v(C),u.c.triggerEventUsingElementId(s.i.FULL_VIEW_IMAGE_HOVER,void 0,{[s.L.TOOL_USED]:L}))},"aria-label":"Open Full View",className:"absolute inset-0 "}),(0,a.jsxs)(w,{className:"right-2 top-2 opacity-0 transition-all duration-500 group-hover:opacity-100",children:[(0,a.jsx)(x.WithGenericTooltip,{content:"Download",genericTooltipContentProps:{side:"left"},children:(0,a.jsxs)(m.z,{variant:"none",size:"none",className:b,onClick:()=>{u.c.triggerEventUsingElementId(s.i.DOWNLOAD_IMAGE_HOVER,void 0,{[s.L.TOOL_USED]:L}),M()},children:[(0,a.jsx)(d._8,{className:"stroke-[1.5]"}),(0,a.jsx)("span",{className:"sr-only",children:"Download"})]})}),!P&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.WithGenericTooltip,{content:"Full View",genericTooltipContentProps:{side:"left"},children:(0,a.jsxs)(m.z,{variant:"none",size:"none",className:b,onClick:()=>{v(C),u.c.triggerEventUsingElementId(s.i.FULL_VIEW_IMAGE_HOVER,void 0,{[s.L.TOOL_USED]:L})},children:[(0,a.jsx)(d.MZ,{className:"stroke-[1.5]"}),(0,a.jsx)("span",{className:"sr-only",children:"Full View"})]})}),(0,a.jsx)("span",{className:"m-1 h-[2px] w-[18px] rounded bg-neutral-0 bg-opacity-[0.24]"})]}),(0,a.jsx)(x.WithGenericTooltip,{content:"Delete",genericTooltipContentProps:{side:"left"},children:(0,a.jsxs)(m.z,{size:"none",variant:"none",className:(0,g.cn)("hover:text-error-500 dark:hover:text-error-500",b),onClick:()=>{R.openModal(),u.c.triggerEventUsingElementId(s.i.DELETE_IMAGE_HOVER,void 0,{[s.L.TOOL_USED]:L})},children:[(0,a.jsx)(d.XH,{className:"stroke-[1.5]"}),(0,a.jsx)("span",{className:"sr-only",children:"Delete"})]})}),(0,a.jsx)(f.G,{imageId:C,modalContainer:A,handleDeleteImage:j,customModelControls:R})]}),(0,a.jsxs)(w,{className:"bottom-2 right-2 opacity-0 transition-all duration-500 group-hover:opacity-100",children:[(0,a.jsx)(x.WithGenericTooltip,{content:T?"Upscaled":"Upscale",genericTooltipContentProps:{side:"left"},children:(0,a.jsxs)(m.z,{variant:T?"primary":"none",size:"none",onClick:()=>{u.c.triggerEventUsingElementId(s.i.UPSCALE_IMAGE_HOVER,void 0,{[s.L.TOOL_USED]:L}),null==l||l(C)},className:(0,g.cn)(b,{"bg-primary-500 hover:bg-primary-600 hover:bg-opacity-100 focus:bg-primary-500":T}),children:[(0,a.jsx)(d.yW,{className:"stroke-[1.5]"}),(0,a.jsx)("span",{className:"sr-only",children:"Upscale"})]})}),n&&(0,a.jsx)(x.WithGenericTooltip,{content:"Variate",genericTooltipContentProps:{side:"left"},children:(0,a.jsxs)(m.z,{variant:"none",size:"none",onClick:()=>{o||(u.c.triggerEventUsingElementId(s.i.VARIATE_IMAGE_HOVER,void 0,{[s.L.TOOL_USED]:L}),null==y||y(C))},className:b,children:[(0,a.jsx)(d.lw,{className:"h-6 w-6 stroke-[1.5]"}),(0,a.jsx)("span",{className:"sr-only",children:"Variate"})]})})]}),_&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"absolute right-0 top-0 rounded-bl-lg bg-black bg-opacity-[0.24] p-1 text-neutral-0 opacity-100 transition-all duration-500 group-hover:opacity-0",children:(0,a.jsx)(d.lw,{className:"h-5 w-5 stroke-[1.5]"})}),(0,a.jsxs)("div",{className:"group/og-image absolute bottom-2 left-2 overflow-hidden rounded-lg border border-neutral-0 border-opacity-[0.24] opacity-0 transition-all duration-500 group-hover:opacity-100 ".concat(t.thumbnailSize),onClick:D,onKeyDown:D,role:"button",tabIndex:0,children:[(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-lg bg-black bg-opacity-60 opacity-0 transition-all duration-500 group-hover/og-image:opacity-100",children:(0,a.jsx)("span",{className:"text-base font-normal text-neutral-0",children:"Original"})}),O&&(0,a.jsx)("img",{src:O,alt:"Original",className:"h-full w-full rounded-lg object-cover"})]})]}),P&&(0,a.jsx)(h,{onClick:N,imgSrc:k})]})},y=e=>{let{aspectRatio:t,isUserPremium:i,image:n,...s}=e,{isRenderedInsideCanvas:c}=(0,r.B)(),p=c?l.Oe[t]:l.bk[t],{isLoading:d=!1}=n;return d?(0,a.jsx)(o,{placeholderSettings:p}):(0,a.jsx)(j,{image:n,placeholderSettings:p,...s})}},14976:function(e,t,i){i.d(t,{d:function(){return n},h:function(){return a}});let a=e=>e(e=>{let{collections:t}=e,i=e.selectedCollectionId;if(!i)return;let a=t.findIndex(e=>e.id===i);return t[a]}),n=e=>e(e=>{let{collections:t}=e,i=e.selectedCollectionId;if(!i)return;let a=t.findIndex(e=>e.id===i),{images:n}=t[a],o=e.selectedImageId;if(!o)return;let l=n.findIndex(e=>e.id===o);return n[l]})},72811:function(e,t,i){i.d(t,{l:function(){return a},p:function(){return n}});let a=(e,t)=>{var i;return t&&null!==(i=e.style_id[t.model_id])&&void 0!==i?i:e.style_id._},n=(e,t,i)=>(void 0===i.hdr_toggle||i.hdr_toggle)&&t?e.high_res_results["1"]:0},30653:function(e,t,i){i.d(t,{X:function(){return s}});var a=i(57437),n=i(24528);let o=e=>{let{children:t,className:i,...o}=e;return(0,a.jsx)("div",{className:(0,n.cn)("relative flex h-full flex-col overflow-hidden bg-neutral-20 transition-all duration-500 dark:bg-neutral-800",i),...o,children:t})};o.displayName="CommonToolsLayout";let l=e=>{let{children:t}=e;return(0,a.jsx)("header",{className:"w-full",children:t})};l.displayName="CommonToolsLayoutHeader";let r=e=>{let{children:t}=e;return(0,a.jsx)("div",{className:"flex h-full flex-1 gap-1 overflow-hidden",children:(0,a.jsx)("main",{className:"flex flex-1 overflow-hidden",children:t})})};r.displayName="CommonToolsLayoutBody";let s=Object.assign(o,{Header:l,Body:r})},57086:function(e,t,i){i.d(t,{M:function(){return l}});var a=i(52247),n=i(11141),o=i(70778);let l=new n.hE({baseURL:a.v.CANVAS_API_URL,defaultHeadersGenerator:o.A});l.interceptors.response.use(async e=>{if(e.data.errors){var t,i;throw Error((null===(i=e.data.errors)||void 0===i?void 0:null===(t=i[0])||void 0===t?void 0:t.message)||"")}return e})},84977:function(e,t,i){i.d(t,{q:function(){return l}});var a=i(59772),n=i(83231),o=i(10579);let l={model:o.SB,aspect_ratio:a.z.string(),style:o.X2.optional(),prompt:n.Pp.optional(),num_images:a.z.number().min(1).max(4),negative_prompt:n.Pp.optional(),high_res_results:a.z.boolean(),seed:n.TI,cfg:a.z.number().min(1).max(20),tags:a.z.record(a.z.string(),a.z.set(a.z.string()))};a.z.object(l)},1916:function(e,t,i){i.d(t,{Ih:function(){return n}});var a=i(57086);i(98606);let n=async(e,t,i,n,o)=>{let l=new FormData;l.append("height",e),l.append("width",t),l.append("size",i),l.append("sizeInBytes",n),l.append("file",o);let{data:r}=await a.M.post("/images",{body:l},{throwOnError:!0});return r}},30507:function(e,t,i){i.d(t,{p:function(){return l}});var a=i(39099),n=i(89291);let o=e=>({...e,image:null,croppedImage:null}),l=(0,a.Ue)()((0,n.tJ)(e=>({persistedFromTextSetting:null,persistedImageRemixSetting:null,persistedTextToImageSetting:null,persistFromTextSetting:t=>e({persistedFromTextSetting:t}),persistImageRemixSetting:t=>{let{image:i,imageCroppedFrom:a,...n}=t;return e({persistedImageRemixSetting:n})},persistTextToImageSetting:t=>{let{image_to_image:i,image_structure:a,face_image:n,style_image:l,...r}=t;return e({persistedTextToImageSetting:{...r,face_image:o(n),style_image:o(l),image_to_image:o(i),image_structure:o(a)}})},resetPersistToolSettingStore:()=>e({persistedFromTextSetting:null,persistedImageRemixSetting:null,persistedTextToImageSetting:null})}),{name:"persist-tool-setting"}))},7406:function(e,t,i){i.d(t,{Cs:function(){return u},Ex:function(){return p},Nx:function(){return c},Qz:function(){return o},Vo:function(){return m},Xy:function(){return s},YX:function(){return n},ZK:function(){return r},q4:function(){return l},ti:function(){return d}});var a=i(97382);function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!e.drawPixelGrids)return;let i=e.getSelectionContext();if(!i)return;i.save();let[n,o,l,r,s,c]=e.viewportTransform;i.transform(n,o,l,r,s,c);let p=e.getViewportTransformBounds(),d=p.height,u=p.width;i.beginPath(),i.lineWidth=1/t,i.strokeStyle="rgba(0, 0, 0, 0.07)";for(let e=0;e<=u;e++){var m=Math.ceil(p.left)+e,x=new a.fabric.Point(m,p.top),g=new a.fabric.Point(m,p.bottom);i.moveTo(x.x,x.y),i.lineTo(g.x,g.y)}for(let e=0;e<=d;e++){var f=Math.ceil(p.top)+e,v=new a.fabric.Point(p.left,f),h=new a.fabric.Point(p.right,f);i.moveTo(v.x,v.y),i.lineTo(h.x,h.y)}i.stroke(),i.restore()}function o(e){return e.angle=e.angle%360||0,e.angle<0&&(e.angle+=360),e.angle}function l(e,t){t.getObjects("artboard").forEach(t=>{e.intersectsWithObject(t)&&t.addChild(e)})}let r=e=>new Promise((t,i)=>{let a=new FileReader;a.addEventListener("load",()=>{var e;let n=null===(e=a.result)||void 0===e?void 0:e.toString();n?t(n):i(Error("Cant read file"))}),a.readAsDataURL(e)}),s=e=>new Promise((t,i)=>{let a=new FileReader;a.addEventListener("load",()=>{var e;let n=null===(e=a.result)||void 0===e?void 0:e.toString();n?t(n):i(Error("Cant read file"))}),a.readAsText(e)}),c=e=>new Promise((t,i)=>{try{a.fabric.loadSVGFromString(e,async(e,i)=>{let n=a.fabric.util.groupSVGElements(e,i);t(n)})}catch(e){i(e)}}),p=e=>new Promise((t,i)=>{e.addEventListener("change",()=>{e.files&&e.files.length>0?t(e.files[0]):i(Error("No file selected"))},{once:!0})}),d=(e,t)=>{if(!t.height||!t.width)return;let i=e.width,a=e.height,n=t.height,o=i/t.width;Number.isNaN(o)||Number.isNaN(a/n)||e.aspectRatio!==t.aspectRatio||e.forEachObject(e=>{e.scaleX*=o,e.scaleY*=o,e.left*=o,e.top*=o,e.dirty=!0,e.setCoords()})},u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/*, .svg",t=document.createElement("input");return t.type="file",t.accept=e,t.style.display="none",t},m=(e,t)=>{let i=e.getScaledWidth(),a=t.width,n=t.height;i>a&&(e.scaleToWidth(a),e.setCoords()),e.getScaledHeight()>n&&(e.scaleToHeight(n),e.setCoords()),t.requestRenderAll()}},79123:function(e,t,i){i.d(t,{M6:function(){return u},NA:function(){return m},PX:function(){return f},SB:function(){return b},ZO:function(){return p},aW:function(){return x},dO:function(){return h},hl:function(){return d},nU:function(){return g},qP:function(){return v},uq:function(){return w}});var a=i(97382),n=i(20920),o=i(27104),l=i(1916),r=i(8127),s=i(94203),c=i(7406);function p(e){try{if(e)return JSON.parse(JSON.stringify(e));return null}catch(e){return console.error(e),null}}let d=(e,t)=>{let i=o.r[e.type];return new File([e],t||"".concat((0,n.Z)(),".").concat(i),{lastModified:new Date().getTime(),type:e.type})},u=async e=>d(await (0,r.K$)(e)),m=e=>new Promise(t=>{let i=new Image;i.crossOrigin="Anonymous","string"==typeof e&&(i.onload=()=>{t(i)},i.src=e)}),x=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(a=>{t.setSrc(e,()=>{var e;t.updatePhotoCanvas(),t.setCoords(),null===(e=t.canvas)||void 0===e||e.renderAll(),a(!0)},i)})},g=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{x:-1,y:-1},r=e.viewportTransform.slice(0),p=e.getZoom(),d=-1!==l.x?{x:(-r[4]+l.x)/p,y:(-r[5]+l.y)/p}:{x:(-r[4]+e.width/2)/p,y:(-r[5]+e.height/2)/p};return new Promise(l=>{a.fabric.Photo.fromURL(t,a=>{a.set({src:t,prompt:o,width:a.width,height:a.height,left:d.x,top:d.y,title:(0,s.t)("photo"),aiContainer:n,__drawMode:i}),a.updatePhotoCanvas(),i?e.enterShapeDrawMode(a):(e.add(a),(0,c.q4)(a,e),e.discardActiveObject(),e.setActiveObject(a),e.fire("user:object:added",{target:a})),l(!0)},{crossOrigin:"Anonymous"})})},f=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{left:0,top:0};return new Promise(r=>{n(!0),Promise.all([u(t),m(t)]).then(n=>{let[c,p]=n,d=e.viewportTransform.slice(0),u=e.getZoom(),m={x:o.left||(-d[4]+e.width/2)/u,y:o.top||(-d[5]+e.height/2)/u},x=new a.fabric.Photo(p,{src:t,prompt:i,width:p.naturalHeight,height:p.naturalHeight,left:m.x,top:m.y,title:(0,s.t)("photo"),aiContainer:!1});e.add(x),r(!0),(0,l.Ih)(p.naturalHeight.toString(),p.naturalWidth.toString(),c.size.toString(),c.size.toString(),c).then(t=>{let i=t.file;x.src=i,x.setSrc(i,()=>{var t;x.updatePhotoCanvas(),x.setCoords(),null===(t=x.canvas)||void 0===t||t.renderAll(),e.fire("user:object:added",{target:x})})}).catch(()=>{r(!1)})})})},v=e=>!!e&&e instanceof a.fabric.Artboard,h=(e,t)=>{let i=function(e,t){for(e=Math.abs(e),t=Math.abs(t);t;){var i=t;t=e%t,e=i}return e}(e,t);return"".concat((e/i).toFixed(0),":").concat((t/i).toFixed(0))},w=e=>0===e.complexity()&&!(e.fill instanceof a.fabric.Pattern),b=e=>!!(e&&("string"!=typeof e&&"pattern"===e.type||e instanceof a.fabric.Pattern))},94203:function(e,t,i){i.d(t,{t:function(){return o}});var a=i(47802);let n={photo:"AI Container",group:"Group"},o=e=>{let t=(0,a.EN)(1e6);return"".concat(n[e]," ").concat(t)}},98606:function(e,t,i){i.d(t,{u:function(){return n}});var a=i(57086);let n=async(e,t)=>{let{data:i}=await a.M.post("/graphql",{...t,body:{query:e,variables:{}},headers:{"Content-Type":"application/json"}},{throwOnError:!0});return i}}}]);