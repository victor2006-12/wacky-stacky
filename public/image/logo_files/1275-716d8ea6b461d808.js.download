(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1275],{24654:function(){},42395:function(e,t,l){"use strict";l.d(t,{FromTextFormProvider:function(){return C},K:function(){return k}});var r=l(57437),a=l(31014),n=l(16463),i=l(97334),s=l.n(i),o=l(2265),c=l(39343),u=l(91606),d=l(39768),m=l(14976),g=l(27229),x=l(59772),p=l(84977);let f=x.z.object({...p.q,randomPromptClicked:x.z.boolean().optional().default(!1)});var _=l(5672),v=l(30507),h=l(10733),y=l(47802);let{ASPECT_RATIO:j}=d.TOOLS_SETTINGS,I=new Set(Object.values(j.content).map(e=>{let{value:t}=e;return t})),C=e=>{var t,l;let i,{children:d,isCanvas:x}=e,p=(0,n.useSearchParams)(),{fromText:j}=(0,h.Td)()(e=>e.defaultSettings),C=(0,g.HO)(j.styleListId),k=(0,g.VI)(j.modelListId);try{let{feed_item:e}=s().parse(p.toString());i=e}catch(e){i=null}let N=(0,g.HO)(Number(null!==(t=null==i?void 0:i.styleId)&&void 0!==t?t:-1)),S=(0,g.Qp)(null!==(l=null==i?void 0:i.model)&&void 0!==l?l:"None"),w=(0,c.cI)({resolver:(0,a.F)(f),defaultValues:{...j,style:C,model:k,randomPromptClicked:!1},mode:"onChange"}),b=(0,v.p)(e=>e.persistedFromTextSetting),T=(0,m.h)(_.cg),E=(0,m.h)(_.TI),L=x?T:E,O=(0,u.O_)();return(0,o.useEffect)(()=>{if(!O)return;if(!L){if(!b){w.setValue("style",C),k&&w.setValue("model",k);let e=(0,y.ER)();e&&w.setValue("prompt",e);return}let e=(0,y.ER)();e?w.reset({...b,prompt:e}):w.reset({...b});return}let{settings:{num_images:e,...t}}=L,l=w.getValues("num_images");null==w||w.reset({...t,num_images:l})},[L,w,C,k,O]),(0,o.useEffect)(()=>{if(!O||!i)return;let e=I.has(i.aspectRatio);w.setValue("prompt",i.prompt),w.setValue("style",-1===N.id?C:N),w.setValue("model",S),w.setValue("high_res_results",(null==i?void 0:i.highResResults)==="true"),w.setValue("aspect_ratio",e?i.aspectRatio:j.aspect_ratio),w.setValue("cfg",i.cfgScale?Number(i.cfgScale):j.cfg),w.setValue("seed",i.seed?Number(i.seed):void 0)},[w,O]),(0,r.jsx)(c.RV,{...w,children:d})},k=()=>{let e=(0,c.Gc)();return(0,o.useMemo)(()=>({formHook:e}),[e])}},31355:function(e,t,l){"use strict";l.d(t,{V:function(){return a}});var r=l(57437);let a=e=>{let{className:t}=e;return(0,r.jsxs)("svg",{width:"500",height:"500",fill:"none",viewBox:"0 0 500 500",className:t,children:[(0,r.jsxs)("g",{clipPath:"url(#IllustrationBackground_a)",className:"dark:opacity-50",children:[(0,r.jsx)("path",{fill:"currentColor",className:"text-neutral-40 transition-all duration-500 dark:text-neutral-700",d:"m100.648 320.362-26.545 13.856a.461.461 0 0 0-.136.711l19.578 22.673a.462.462 0 0 0 .433.152l28.884-5.361a.462.462 0 0 0 .293-.719l-21.915-31.168a.463.463 0 0 0-.592-.144ZM195.013 327.117l-33.971 28.1c-.165.136-.247.204-.291.298-.044.093-.044.2-.044.413v24.251c0 .442 0 .662.138.798s.359.132.8.125l312.452-5.06c.108-.002.162-.002.213-.015.052-.013.1-.038.196-.087l24.819-12.801c.244-.126.366-.189.433-.299.067-.111.067-.248.067-.522v-78.294c0-1.981 0-2.971-.38-3.039-.381-.068-.723.861-1.409 2.719l-11.898 32.237c-.172.466-.258.7-.456.774-.198.074-.416-.045-.852-.283l-8.916-4.86c-.348-.19-.522-.285-.695-.243-.173.042-.285.205-.509.533l-28.782 42.112c-.123.18-.185.27-.276.322-.091.053-.199.061-.416.078l-80.503 6.177a.934.934 0 0 1-.273.001.947.947 0 0 1-.247-.115l-47.725-26.62c-.221-.124-.332-.185-.453-.185s-.231.063-.452.188l-37.714 21.37c-.259.147-.389.221-.529.211-.14-.01-.257-.102-.493-.286l-20.61-16.047c-.124-.096-.186-.144-.259-.17-.073-.025-.152-.025-.309-.025h-9.017c-.19 0-.284 0-.37-.035-.085-.035-.152-.103-.285-.237l-24.015-24.179c-.331-.332-.496-.499-.698-.491-.202.007-.354.185-.659.541l-15.777 18.415c-.274.32-.411.48-.597.498-.185.017-.35-.114-.68-.377l-7.394-5.901c-.281-.224-.421-.336-.585-.335-.164.002-.302.116-.579.345Z"}),(0,r.jsx)("path",{fill:"currentColor",className:"text-neutral-50 transition-all duration-500 dark:text-neutral-600",d:"m50.162 307.411-26.89 33.338c-.255.315-.381.472-.37.652.013.181.16.32.453.598l56.994 54.019c.173.164.26.246.37.277.11.031.226.006.459-.044l43.443-9.291c.167-.036.25-.053.332-.041.083.012.157.053.307.135l72.849 40.127c.293.161.439.242.592.22.152-.022.27-.14.507-.376l15.3-15.318c.171-.171.256-.257.367-.291.111-.033.229-.01.467.038l31.825 6.338c.072.014.108.021.144.023a.985.985 0 0 0 .146-.012l98.647-11.74c.066-.007.098-.011.131-.01.033 0 .065.006.13.017l49.377 8.238c.15.025.225.037.298.026.074-.012.142-.047.277-.116l77.283-39.799c.416-.214.624-.322.678-.516.054-.195-.07-.394-.317-.792l-30.838-49.665c-.335-.539-.502-.808-.751-.815-.248-.006-.429.254-.791.774l-20.473 29.427c-.121.174-.182.261-.27.312-.089.052-.194.061-.405.08l-99.1 8.925c-.215.019-.322.029-.419-.007-.098-.036-.173-.113-.324-.267l-13.803-14.09c-.376-.383-.564-.575-.786-.552-.222.023-.366.25-.653.704l-14.799 23.361c-.178.282-.268.423-.412.477-.144.055-.304.008-.625-.084l-55.537-16.089c-.185-.053-.277-.08-.37-.069-.093.011-.176.059-.343.154l-28.081 15.975c-.191.109-.287.163-.393.17-.106.007-.208-.035-.412-.118l-60.43-24.662c-.122-.049-.182-.074-.247-.081a.97.97 0 0 0-.258.026l-49.213 8.41c-.249.042-.373.064-.487.023-.113-.04-.197-.135-.363-.325l-41.803-47.723c-.335-.383-.503-.575-.718-.571-.215.005-.375.203-.695.6Z"}),(0,r.jsx)("ellipse",{cx:"276.117",cy:"274.795",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:"1.259",ry:"1.675"}),(0,r.jsx)("ellipse",{cx:"230.129",cy:"152.124",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:"1.215",ry:"1.616"}),(0,r.jsx)("ellipse",{cx:"74.627",cy:"232.456",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".868",ry:"1.154"}),(0,r.jsx)("ellipse",{cx:"93.699",cy:"46.815",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".787",ry:"1.047"}),(0,r.jsx)("ellipse",{cx:"455.001",cy:"89.271",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".472",ry:".628"}),(0,r.jsx)("ellipse",{cx:"35.355",cy:"71.265",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".472",ry:".628"}),(0,r.jsx)("ellipse",{cx:"29.457",cy:"241.625",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".472",ry:".628"}),(0,r.jsx)("ellipse",{cx:"305.212",cy:"196.128",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".63",ry:".837"}),(0,r.jsx)("ellipse",{cx:"106.669",cy:"72.859",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".63",ry:".837"}),(0,r.jsx)("ellipse",{cx:"140.684",cy:"319.397",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".63",ry:".837"}),(0,r.jsx)("ellipse",{cx:"152.485",cy:"132.416",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".63",ry:".837"}),(0,r.jsx)("ellipse",{cx:"440.581",cy:"40.08",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".63",ry:".837"}),(0,r.jsx)("ellipse",{cx:"273.973",cy:"140.265",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".63",ry:".837"}),(0,r.jsx)("ellipse",{cx:"156.305",cy:"330.939",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".63",ry:".837"}),(0,r.jsx)("ellipse",{cx:"228.218",cy:"238.227",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".694",ry:".923"}),(0,r.jsx)("ellipse",{cx:"249.958",cy:"328.544",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:"1.259",ry:"1.675"}),(0,r.jsx)("ellipse",{cx:"21.564",cy:"314.232",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:"1.259",ry:"1.675"}),(0,r.jsx)("ellipse",{cx:"128.955",cy:"20.856",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:"1.102",ry:"1.465"}),(0,r.jsx)("ellipse",{cx:"36.713",cy:"182.025",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".787",ry:"1.047"}),(0,r.jsx)("ellipse",{cx:"156.971",cy:"209.688",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:"1.102",ry:"1.465"}),(0,r.jsx)("ellipse",{cx:"372.674",cy:"91.955",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:"1.102",ry:"1.465"}),(0,r.jsx)("ellipse",{cx:"278.61",cy:"12.084",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:"1.102",ry:"1.465"}),(0,r.jsx)("ellipse",{cx:"453.314",cy:"297.553",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".521",ry:".693"}),(0,r.jsx)("ellipse",{cx:"490.532",cy:"179.926",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".944",ry:"1.256"}),(0,r.jsx)("ellipse",{cx:"488.796",cy:"13.26",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".944",ry:"1.256"}),(0,r.jsx)("ellipse",{cx:"214.585",cy:"55.273",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".944",ry:"1.256"}),(0,r.jsx)("ellipse",{cx:"116.892",cy:"289.136",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".787",ry:"1.047"}),(0,r.jsx)("ellipse",{cx:"67.1",cy:"134.113",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".63",ry:".837"}),(0,r.jsx)("ellipse",{cx:"451.233",cy:"212.142",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".868",ry:"1.154"}),(0,r.jsx)("ellipse",{cx:"383.719",cy:"67.867",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:"1.041",ry:"1.385"}),(0,r.jsx)("ellipse",{cx:"396.218",cy:"312.096",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:".694",ry:".923"}),(0,r.jsx)("ellipse",{cx:"375.071",cy:"196.252",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:"1.417",ry:"1.884"}),(0,r.jsx)("ellipse",{cx:"350.399",cy:"326.408",fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",rx:"1.041",ry:"1.385"}),(0,r.jsx)("path",{fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",d:"M80.464 393.281 1.559 318.478c-.667-.632-1-.948-1.28-.828-.279.12-.279.579-.279 1.498v179.929c0 .435 0 .653.135.788s.353.135.788.135h197.154c.435 0 .653 0 .788-.135s.135-.353.135-.788v-73.991c0-.267 0-.4-.065-.509-.064-.109-.181-.173-.415-.301l-73.084-39.958c-.149-.081-.223-.122-.305-.134-.082-.012-.165.006-.331.041l-43.508 9.289c-.233.05-.35.074-.46.044-.109-.031-.195-.113-.368-.277Z"}),(0,r.jsx)("path",{fill:"currentColor",className:"text-neutral-60 transition-all duration-500 dark:text-neutral-500",d:"m214.456 394.177-90.135 104.294c-.57.66-.854.989-.731 1.259.124.269.559.269 1.43.269l374.057-.267c.435 0 .653 0 .788-.135.135-.136.135-.353.135-.788v-162.18c0-.722 0-1.084-.234-1.216-.234-.133-.544.053-1.164.424l-102.269 61.225c-.15.09-.225.135-.309.15-.084.015-.169-.002-.341-.035l-49.318-9.562a.908.908 0 0 0-.151-.023.983.983 0 0 0-.151.014l-98.616 13.639a1.023 1.023 0 0 1-.169.016c-.042-.002-.083-.012-.166-.031l-31.749-7.348c-.265-.061-.397-.092-.519-.052s-.211.142-.388.347Z"}),(0,r.jsx)("path",{fill:"currentColor",className:"text-neutral-80 transition-all duration-500 dark:text-neutral-400",d:"m214.854 471.978-59.019 26.252c-1.554.691-2.331 1.037-2.254 1.403.078.366.929.365 2.63.364l342.865-.249c.435 0 .652 0 .787-.135.136-.136.136-.353.136-.788V382.744c0-.63 0-.946-.208-1.083-.207-.137-.497-.013-1.077.234l-79.149 33.673c-.133.056-.199.084-.27.091-.071.007-.141-.008-.282-.038l-71.061-15.017c-.164-.034-.246-.052-.327-.04-.081.012-.155.051-.302.131l-132.469 71.283Z"})]}),(0,r.jsx)("defs",{children:(0,r.jsx)("clipPath",{id:"IllustrationBackground_a",children:(0,r.jsx)("rect",{width:"500",height:"500",fill:"currentColor",className:"text-neutral-0 transition-all duration-500",rx:"4"})})})]})}},35093:function(e,t,l){"use strict";l.d(t,{FromTextContent:function(){return K}});var r=l(57437),a=l(2265),n=l(42395),i=l(32057),s=l(87483),o=l(14976),c=l(89565),u=l(16092),d=l(47802);let m=async e=>{let t;return e.data.seed||(t=(0,d.X4)()),(0,u.o)(e.data,e.isPremium,t)},g=()=>{let e=(0,c.useMutation)(m);return Object.assign(e,{cancelRequest:()=>{e.isLoading&&(0,u.C)()}})};var x=l(99900),p=l(72143),f=l(8127),_=l(54795);let v=async(e,t,l)=>{var r;if(!l)throw Error("No image provided");let a={image:await (0,f.K$)(l),prompt:null!==(r=e.prompt)&&void 0!==r?r:"",style_id:e.model.model_id,seed:t};return(null==e?void 0:e.cfg)&&(a.cfg=null==e?void 0:e.cfg),(null==e?void 0:e.steps)&&(a.steps=null==e?void 0:e.steps),(null==e?void 0:e.strength)&&(a.strength=null==e?void 0:e.strength),(null==e?void 0:e.negative_prompt)&&(a.negative_prompt=null==e?void 0:e.negative_prompt),(0,d.wh)(a)},h=async(e,t,l,r)=>{let a=await v(e,r,t),{data:n}=await p.p.post(_.TG.VARIATE,{body:a,headers:(0,_.kw)(l)},{throwOnError:!0});return(0,f.RJ)(n)},y=()=>(0,c.useMutation)(e=>h(e.settings,e.imgSrc,e.isPremium,e.randomSeed));var j=l(5672),I=l(81750),C=l(14125),k=l(29328),N=l(82442),S=l(24528),w=l(69085),b=l(96521),T=l(31355),E=l(30606),L=l(16463),O=l(80732),A=l(24019),V=l(63218),P=l(96994),R=l(37079),M=l(6498),F=l(72811);let U=()=>{var e;let{formHook:t}=(0,n.K)(),{isLoading:l,data:r}=(0,M.X)(),a=0;if(l)return{cost:a};let i=null==r?void 0:r[_.TG.FROM_TEXT];if(!i)return{cost:a};let{criteria:s}=i,o=t.watch("model"),c=t.watch("num_images"),u=t.watch("high_res_results");return{cost:(a+=(0,F.l)(s,o)+(0,F.p)(s,u,o)+(null!==(e=i.base)&&void 0!==e?e:0))*c}};var G=l(85951);let H=e=>{var t,l,s,o,c;let{isPremium:u,generateImageMutation:d}=e,m=(0,L.usePathname)(),{aggregator:g}=(0,G.O)(),{isRenderedInsideCanvas:x}=(0,i.B)(),p=x?j.cg:j.TI,f=p(e=>e.addImageToCollectionWithLoading),_=p(e=>e.completeImageGenerationLoading),v=p(e=>e.deleteLoadingImage),{cost:h}=U(),{formHook:y}=(0,n.K)(),S=(0,L.useRouter)(),w=(0,I.m8)()(e=>e.user),{data:b}=(0,M.j)(),T=(0,I.m8)()(e=>e.subscription),E=(0,C.L)(T),F=null===(s=E.stripeSubscription)||void 0===s?void 0:null===(l=s.StripePrice)||void 0===l?void 0:null===(t=l.StripeProduct)||void 0===t?void 0:t.name,H=null===(c=E.stripeSubscription)||void 0===c?void 0:null===(o=c.StripePrice)||void 0===o?void 0:o.billingInterval,B=E.isSubscriptionActive?"Premium":"Free",D=x?"Canvas":"Dashboard",{page:K,source:X}=(0,P.V)(),Z=(null==b?void 0:b.platformSpecificTotal)?b.platformSpecificTotal-h:0,q=(0,a.useCallback)(async e=>{let t=f(e);try{let l=await d.mutateAsync({data:e,isPremium:u});if(!l)throw Error("Processing stopped");return _({image:l,imageId:t.imageId}),{isSuccess:!0}}catch(e){return v(t.imageId),(0,k.eL)(e,u),{isSuccess:!1,error:e}}},[f,_,v,d,u]),z=(0,L.useSearchParams)().get("generate"),$=(0,a.useCallback)(async e=>{var t,l,r,a,n,i,s,o,c;if(!e.prompt){N.Am.error("Please enter a prompt");return}if(!w){S.push("".concat(V.H7.TOOLS_AUTH,"?redirect=").concat(m));return}let u=await Promise.all(Array.from({length:e.num_images}).map(()=>q(e))),d=u.reduce((e,t)=>{let l=e.successCount,r=e.failureCount,a=e.error;return t.isSuccess?l++:(a=t.error,r++),{...e,successCount:l,failureCount:r,error:a}},{successCount:0,failureCount:0,totalCount:u.length,error:Error("Default")}),x=Object.values(e.tags).map(e=>Array.from(e)).flat().join(","),p=Object.entries(e.tags).filter(e=>{let[t,l]=e;return l.size>0}).map(e=>{let[t,l]=e;return t}).join(",");d.totalCount===d.successCount?g.log(O.H.image_generated.withProperties({source:X,feature:"Text to Image",page_name:K,aspect_ratio:e.aspect_ratio,number_of_images:e.num_images,cfg_scale:e.cfg,hdr_enabled:e.high_res_results&&e.model.hdr_toggle,model_id:e.model.id,model_used:e.model.name,style_used:null===(t=e.style)||void 0===t?void 0:t.style_name,negative_prompt_used:!!e.negative_prompt,negative_prompt_length:null===(l=e.negative_prompt)||void 0===l?void 0:l.length,seed:e.seed,email:null==w?void 0:w.email,tokens_remaining:Z,user_account_status:B,user_plan:F,user_plan_period:H,prompt_length:null===(r=e.prompt)||void 0===r?void 0:r.length,processing_status:"Successful",tag_used:x.length?x:"NA",tag_category:p.length?p:"NA",generation_source:D,random_prompt_used:e.randomPromptClicked,distinct_id:null==w?void 0:w.id})):0===d.successCount?g.log(O.H.image_generated.withProperties({source:X,feature:"Text to Image",page_name:K,aspect_ratio:e.aspect_ratio,number_of_images:e.num_images,cfg_scale:e.cfg,hdr_enabled:e.high_res_results&&e.model.hdr_toggle,model_id:e.model.id,model_used:e.model.name,style_used:null===(a=e.style)||void 0===a?void 0:a.style_name,negative_prompt_used:!!e.negative_prompt,negative_prompt_length:null===(n=e.negative_prompt)||void 0===n?void 0:n.length,seed:e.seed,email:null==w?void 0:w.email,tokens_remaining:Z,user_account_status:B,user_plan:F,user_plan_period:H,prompt_length:null===(i=e.prompt)||void 0===i?void 0:i.length,processing_status:"Failure",processing_error:(0,k.t$)(d.error),tag_used:x.length?x:"NA",tag_category:p.length?p:"NA",generation_source:D,random_prompt_used:e.randomPromptClicked,distinct_id:null==w?void 0:w.id})):g.log(O.H.image_generated.withProperties({source:X,feature:"Text to Image",page_name:K,aspect_ratio:e.aspect_ratio,number_of_images:e.num_images,cfg_scale:e.cfg,hdr_enabled:e.high_res_results&&e.model.hdr_toggle,model_id:e.model.id,model_used:e.model.name,style_used:null===(s=e.style)||void 0===s?void 0:s.style_name,negative_prompt_used:!!e.negative_prompt,negative_prompt_length:null===(o=e.negative_prompt)||void 0===o?void 0:o.length,seed:e.seed,email:null==w?void 0:w.email,tokens_remaining:Z,user_account_status:B,user_plan:F,user_plan_period:H,prompt_length:null===(c=e.prompt)||void 0===c?void 0:c.length,processing_status:"Partial",processing_error:(0,k.t$)(d.error),tag_used:x.length?x:"NA",tag_category:p.length?p:"NA",generation_source:D,random_prompt_used:e.randomPromptClicked,distinct_id:null==w?void 0:w.id})),y.setValue("randomPromptClicked",!1)},[h,S,w,m,q,g,null==b?void 0:b.platformSpecificTotal,y,D,K,X,F,H,B]),Q=y.getValues("prompt");return(0,a.useEffect)(()=>{if("true"===z&&Q&&w){y.handleSubmit($)();let e=new URLSearchParams(window.location.search);e.delete("generate"),S.replace("".concat(m,"?").concat(e.toString()))}},[Q,w,m]),(0,r.jsx)("form",{onSubmit:y.handleSubmit($),children:(0,r.jsx)(R.w,{tagPopoverControlArgs:{control:y.control,name:"tags"},promptFormHook:{tokenCost:h,generateBtnId:A.i.GENERATE_BTN_ID,formHook:y,name:"prompt",isLoading:d.isLoading,onCancel:d.cancelRequest}})})},B=()=>(0,r.jsx)("div",{className:"flex h-full min-h-[520px] w-full flex-1 items-center justify-center",children:(0,r.jsx)("div",{className:"aspect-square max-h-full overflow-hidden rounded bg-neutral-30 object-contain transition-all duration-500 dark:bg-neutral-900",children:(0,r.jsx)(T.V,{})})}),D=()=>(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)("div",{className:"flex max-h-[413px] min-h-[413px] w-full items-center justify-center overflow-hidden rounded-xl bg-neutral-30 object-contain transition-all duration-500 dark:bg-neutral-800",children:(0,r.jsx)(T.V,{className:"h-full w-full"})})}),K=e=>{let{className:t=""}=e,l=(0,I.m8)()(e=>e.subscription),{isSubscriptionActive:c}=(0,C.L)(l),{isRenderedInsideCanvas:u}=(0,i.B)(),m=u?j.cg:j.TI,{collections:p,setSelectedCollection:f}=m(e=>e),_=m(e=>e.deleteImage),v=m(e=>e.setImageLoading),h=m(e=>e.setImagesUpscale),T=(0,o.h)(m),L=m(e=>e.completeImageGenerationLoading),O=m(e=>e.deleteLoadingImage),A=m(e=>e.addImageToCollectionWithLoading),V=m(e=>e.setFocusOfOriginalImage),[P,R]=(0,a.useState)({isModalOpen:!1,initialImageIndex:0}),M=(0,x.X)(),F=y(),{formHook:U}=(0,n.K)(),G=U.watch("num_images"),K=async e=>{v(e,!0);let t=null==T?void 0:T.images.find(t=>t.id===e);if(!t)throw Error("Image not found");try{let l;l=t.upscaleSrc?t.upscaleSrc:await M.mutateAsync({isPremium:c,originalImgSrc:t.src});let r=t.isUpscaled;h(e,l,!t.isUpscaled),r||N.Am.success("Upscaled successfully")}catch(e){(0,k.eL)(e,c)}v(e,!1)},X=(0,a.useCallback)(async e=>{let t=null==T?void 0:T.images.find(t=>t.id===e);if(!t)throw Error("Image not found");let l=null==T?void 0:T.settings;if(!l){N.Am.error("Please generate an image first and then variate it");return}let r=A(l,t),a=(0,d.X4)();try{let e=await F.mutateAsync({isPremium:c,imgSrc:t.src,settings:l,randomSeed:a});if(!e){N.Am.error("Processing stopped"),O(r.imageId);return}let n=[{src:e,randomSeed:a}];L({image:n[0],imageId:r.imageId})}catch(e){O(r.imageId),(0,k.eL)(e,c)}},[A,L,O,c,T,F]),Z=()=>{R({isModalOpen:!1,initialImageIndex:0})},q=e=>{_(e)},{images:z}=null!=T?T:{images:[]},$=U.watch("aspect_ratio"),Q=g(),W=!(0,j.yn)(null==T?void 0:T.settings,U.getValues()),J=u?s.G:E.U;return(0,r.jsxs)("div",{className:(0,S.cn)("hide-scrollbar relative flex h-screen flex-col gap-[34px] overflow-y-auto overflow-x-hidden px-9 py-6",t),children:[(0,r.jsx)(J,{numOfImages:G,renderNoImages:u?D:B,isVariationSupported:!0,selectedCollection:T,aspectRatio:$,handleDeleteImage:q,handleUpscale:K,isUserPremium:c,images:z,isLoading:Q.isLoading,isVariationLoading:F.isLoading,isSettingsChanged:W,handleFullView:e=>{let t=null==T?void 0:T.images.findIndex(t=>t.id===e);void 0!==t&&R({isModalOpen:!0,initialImageIndex:t})},handleImageVariate:X,handleFocusOriginalImage:e=>{var t;e&&(null===(t=document.getElementById(e))||void 0===t||t.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),null==V||V(e,!0),setTimeout(()=>{null==V||V(e,!1)},2500))},collections:p,setSelectedCollection:f}),(0,r.jsx)(H,{generateImageMutation:Q,isPremium:c}),!u&&T&&(0,r.jsx)(w.h,{closeFullViewModal:Z,isFullViewOpen:P.isModalOpen,children:(0,r.jsx)(b.c,{collection:T,getSettingItems:e=>{var t,l;return[{title:"Model",value:null==T?void 0:null===(t=T.settings.model)||void 0===t?void 0:t.name},{title:"Art Style",value:null==T?void 0:null===(l=T.settings.style)||void 0===l?void 0:l.style_name},{title:"Aspect Ratio",value:null==T?void 0:T.settings.aspect_ratio},{title:"Seed",value:e.randomSeed||(null==T?void 0:T.settings.seed),isCopyable:!0},{title:"CFG Scale",value:null==T?void 0:T.settings.cfg}]},handleUpscale:K,handleDeleteImage:q,closeFullViewModal:Z,initialImageIndex:P.initialImageIndex})})]})}},79294:function(e,t,l){"use strict";l.d(t,{m:function(){return _}});var r=l(57437),a=l(2265),n=l(24019),i=l(39768),s=l(42395),o=l(32057),c=l(27229),u=l(10733),d=l(81750),m=l(43664),g=l(24528),x=l(13297);let{ASPECT_RATIO:p}=i.TOOLS_SETTINGS,f=Object.values(p.content),_=e=>{let{isSubscriptionActive:t}=e,{isRenderedInsideCanvas:l,modalContainer:i,activeTool:p}=(0,o.B)(),{formHook:_}=(0,s.K)(),v=(0,d.m8)()(e=>e.favoriteStyles),h=(0,u.Td)()(e=>e.styles),y=(0,u.Td)()(e=>e.popularStyles),{fromText:j}=(0,u.Td)()(e=>e.defaultSettings),I=(0,c.HO)(j.styleListId),C=(0,c.VI)(j.modelListId),k=(0,d.m8)()(e=>e.favoriteModels),N=(0,u.Td)()(e=>e.models),S=(0,u.Td)()(e=>e.modelAspectRatioInclusionList),w=(0,u.Td)()(e=>e.popularModels),b=(0,d.m8)()(e=>e.toggleFavorite),T=_.watch("model"),E=_.watch("aspect_ratio"),L=T.model_id,O=(0,a.useMemo)(()=>{let e=S.find(e=>L>=e.minModelId&&L<=e.maxModelId);if(!e)return f;let t=new Set(e.aspectRatioInclusionList);return f.filter(e=>t.has(e.value))},[L,S]);return(0,a.useEffect)(()=>{var e;O.find(e=>e.value===E)||_.setValue("aspect_ratio",null==O?void 0:null===(e=O[0])||void 0===e?void 0:e.value)},[O,E,_]),(0,r.jsxs)(x.Rp.Root,{className:(0,g.cn)({"w-[238px] min-w-[238px] max-w-[238px] p-0":l}),children:[(0,r.jsx)(x.Rp.Item,{children:(0,r.jsx)(x.Ou,{controllerArgs:{name:"num_images",control:_.control}})}),(0,r.jsx)(x.Rp.Item,{children:(0,r.jsx)(x.oM,{aspectRatioValues:O,isSubscriptionActive:t,controllerArgs:{name:"aspect_ratio",control:_.control},isEnabled:T.aspect_ratio_enabled})}),(0,r.jsx)(x.Rp.Item,{children:(0,r.jsx)(x.kk,{controllerArgs:{name:"model",control:_.control},settings:N,popularSettings:w,favoriteSettings:k,defaultSetting:C,toggleFavorite:b,onClickEventFire:e=>{m.c.triggerEventUsingElementId(n.i.TEXT_TO_IMAGE_MODEL,e,{[n.L.TOOL_USED]:p})},asModal:l,modalContainer:i},"fromTextModels")}),(0,r.jsxs)(x.Rp.Item,{children:[(0,r.jsx)(x.RM,{controllerArgs:{name:"style",control:_.control},settings:h,popularSettings:y,favoriteSettings:v,defaultSetting:I,toggleFavorite:b,onClickEventFire:e=>{m.c.triggerEventUsingElementId(n.i.TEXT_TO_IMAGE_STYLE,e,{[n.L.TOOL_USED]:p})},asModal:l,modalContainer:i},"fromTextArtStyle"),(0,r.jsx)(x.yM,{controllerArgs:{name:"high_res_results",control:_.control},isEnabled:T.hdr_toggle})]}),(0,r.jsx)(x.Rp.Item,{children:(0,r.jsx)(x.K0,{formHook:_,name:"negative_prompt"})}),(0,r.jsx)(x.Rp.Item,{children:(0,r.jsx)(x.f0,{controllerArgs:{name:"cfg",control:_.control},cfgEnabled:T.cfg_enabled})}),(0,r.jsx)(x.Rp.Item,{children:(0,r.jsx)(x.H7,{formHook:_,name:"seed"})})]})}},5672:function(e,t,l){"use strict";l.d(t,{TI:function(){return n},cg:function(){return i},yn:function(){return a}});var r=l(67259);let a=(e,t)=>(0,r.Qt)(e,t),n=(0,r.hB)(a),i=(0,r.hB)(a)}}]);